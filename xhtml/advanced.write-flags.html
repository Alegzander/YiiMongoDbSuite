<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="pl">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="robots" content="all" />

	<title>Write Queries Flags - YiiMongoDbSuite Manual</title>
	
	<link rel="stylesheet" type="text/css" href="design/generic.css" media="all"  />
	<link rel="stylesheet" type="text/css" href="design/print.css" media="print" />
	<!--[if lte IE 6]><link rel="stylesheet" href="design/ie.css" type="text/css" /><![endif]-->	
	<!--[if IE 7]><link rel="stylesheet" href="design/ie7.css" type="text/css" /><![endif]-->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17148216-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script></head>
<body>

<div id="wrap">
	<div id="header">
		<h1>YiiMongoDbSuite Manual 1.3.4</h1>
		<h2>Write Queries Flags</h2>
		<p class="generated">@ 31.12.2010</p>
		<p class="location"><a href="../index.html"><strong>Home Page</strong></a> &raquo; <a href="index.html"><strong>User manual</strong></a> &raquo; <a href="advanced.html">The Advanced Stuff</a> &raquo; <a href="advanced.write-flags.html">Write Queries Flags</a></p>
	</div>
	
	<div id="content"><dl class="location"><dt><a href="advanced.html">6. The Advanced Stuff</a><br/>6.6. Write Queries Flags</dt><dd class="prev">6.5. Data Provider Object<br/><a href="advanced.data-provider.html">&laquo; Previous</a></dd><dd class="next">6.7. GridFS<br/><a href="advanced.gridfs.html">Next &raquo;</a></dd></dl>	<h1>6.6. Write Queries Flags</h1><div class="tf_reference"><table><tr><th>Author</th><td>Dariusz GÃ³recki <darek.krk@gmail.com></td></tr></table><hr/></div><blockquote class="important">
  <h4>Quote from PHP Manual:</h4>
  
  <h5>"safe"</h5>
  
  <p>Can be a boolean or integer, defaults to FALSE. If FALSE, the program continues executing without waiting
    for a database response. If TRUE, the program will wait for the database response and throw a MongoCursorException
    if the write operation did not succeed.</p>
  
  <p>If you are using replication and the master has changed, using "safe" will make the driver disconnect from
    the master, throw and exception, and attempt to find a new master on the next operation (your application must
    decide whether or not to retry the operation on the new master).</p>
  
  <p>If you do not use "safe" with a replica set and the master changes, there will be no way for the driver
    to know about the change so it will continuously and silently fail to write.</p>
  
  <p>If safe is an integer, will replicate the insert to that many machines before returning success (or throw
    an exception if the replication times out, see wtimeout).
    This overrides the w variable set on the collection.</p>
  
  <h5>"fsync"</h5>
  
  <p>Boolean, defaults to FALSE. Forces the insert to be synced to disk before returning success. If TRUE, a safe
    insert is implied and will override setting safe to FALSE.</p>
</blockquote>

<!-- # -->

<p>We now can set value for write queries flags FSync and/or Safe on a different scopes:</p>

<ul>
<li>Global scope, by setting it in EMongoDB component class itself (required)</li>
<li>Model scope, bu using <code>ModelClass::model()-&gt;setFsyncFlag($flagValue)</code> or <code>ModelClass::model()-&gt;setSafeFlag($flagValue)</code></li>
<li>Single Model object by using <code>$singleModelObject-&gt;sefFsyncFlag($flag)</code> or <code>$singleModelObject-&gt;sefSafeFlag($flag)</code></li>
</ul>

<blockquote class="important">
  <h4>State of write queries flags is connected</h4>
  
  <p>Setting FSync to <code>TRUE</code>, will set Safe flag to <code>TRUE</code> automatically</p>
</blockquote>

<p>Now, we may want all DB operations to be synced to disk, and we set global FSync flag in MongoDB component config,
but we feagure out that, for ie. massive temporary models like DB logging objects are not important, and for performance
reasons, we whant to disable FSync for this models only.</p>

<p>We may do so: <code>LogModelClass::model()-&gt;setFsyncFlag(false);</code></p>

<p>From now on, all LogModelClass objects will be written to DB without waiting to filesystem sync.</p>

<p>For user comfort, FSync and Safe flags may be set just for single model instance by, <code>$singleModelInstance-&gt;setFsyncFlag(false)</code>,
this will not affect any other model instance.</p>
<dl class="location location-bottom"><dt>6.6. Write Queries Flags<br/><a href="advanced.html">6. The Advanced Stuff</a></dt><dd class="prev"><a href="advanced.data-provider.html">&laquo; Previous</a><br/>6.5. Data Provider Object</dd><dd class="next"><a href="advanced.gridfs.html">Next &raquo;</a><br/>6.7. GridFS</dd></dl>		</div>
	
	<div id="footer">
		<p>Copyright &copy; <a href="http://www.cleverit.com.pl">2010 CleverIT</a></p>
		<p>Available under the terms of license: <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation License 2.1</a></p>
		<p>Generated by <strong>TypeFriendly 0.1.4</strong> by <a href="http://www.invenzzia.org/">Invenzzia</a></p>
	</div>
</div>

</body>
</html>